filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials%>%
filter(date== max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
head(brewing_materials)
brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
brewing_materials%>%
filter(date== max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
library(tidyverse)
library(lubridate)
#install.packages("tidytuesdayR")
# Get the Data
brewing_materials <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv')
beer_taxed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv')
brewer_size <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv')
beer_states <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv')
# Or read in with tidytuesdayR package (https://github.com/thebioengineer/tidytuesdayR)
# PLEASE NOTE TO USE 2020 DATA YOU NEED TO USE tidytuesdayR version ? from GitHub
# Either ISO-8601 date or year/week works!
# Install via devtools::install_github("thebioengineer/tidytuesdayR")
tuesdata <- tidytuesdayR::tt_load('2020-03-31')
tuesdata <- tidytuesdayR::tt_load(2020, week = 14)
brewing_materials <- tuesdata$brewing_materials
brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
head(brewing_materials)
brewing_materials%>%
filter(date== max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
filter(date== max(year(date)) %>%
head(brewing_materials)
brewing_materials%>%
brewing_materials %>%
filter(date == max(date)) %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current)) %>%
ggplot(aes(type, month_current, fill = material_type)) +
geom_col() +
coord_flip()
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date=max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
library(tidyverse)
library(lubridate)
theme_set(theme_light())
brewing_materials <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv') %>%
mutate(date = ymd(paste(year, month, 1))) %>%
filter(year < 2016)
beer_taxed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv')
brewer_size <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv')
beer_states <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv')
```
What ingredients are used in US beer production?
brewing_materials %>%
filter(date == max(date)) %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current)) %>%
ggplot(aes(type, month_current, fill = material_type)) +
geom_col() +
coord_flip()
library(lubridate)
brewing_materials %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Time",
y = "Pounds used in beer production",
fill = "Material")
brewing_materials %>%
filter(str_detect(material_type, "Total.*products")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Time",
y = "Pounds used in beer production",
fill = "Material")
str(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
head(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date == max(date)) %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current)) %>%
ggplot(aes(type, month_current, fill = material_type)) +
geom_col() +
coord_flip()
brewing_materials %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+coord_flip()
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()
brewing_materials %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Time",
y = "Pounds used in beer production",
fill = "Material")
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()
brewing_materials %>%
filter(!str_detect(material_type, "Total")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Time",
y = "Pounds used in beer production",
fill = "Material")
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma)
brewing_materials %>%
filter(str_detect(material_type, "Total.*products")) %>%
mutate(type = fct_reorder(type, month_current, sum)) %>%
ggplot(aes(date, month_current, fill = type)) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
labs(x = "Time",
y = "Pounds used in beer production",
fill = "Material")
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma)
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma)
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production")
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
?regex
?.*
brewing_materials %>%
filter(!str_detect(material_type,"Total.*Product")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials %>%
filter(str_detect(material_type,"Total.*Product")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials %>%
filter(str_detect(material_type,"Total.*Product")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials %>%
filter(str_detect(material_type,"Total.*Products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
head(brewing_materials)
head(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
library(tidyverse)
library(lubridate)
#install.packages("tidytuesdayR")
# Get the Data
brewing_materials <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv')
beer_taxed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv')
brewer_size <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv')
beer_states <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv')
# Or read in with tidytuesdayR package (https://github.com/thebioengineer/tidytuesdayR)
# PLEASE NOTE TO USE 2020 DATA YOU NEED TO USE tidytuesdayR version ? from GitHub
# Either ISO-8601 date or year/week works!
# Install via devtools::install_github("thebioengineer/tidytuesdayR")
tuesdata <- tidytuesdayR::tt_load('2020-03-31')
tuesdata <- tidytuesdayR::tt_load(2020, week = 14)
brewing_materials <- tuesdata$brewing_materials
brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
#Question1
head(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
View(brewing_materials)
brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
#Question1
head(brewing_materials)
brewing_materials <- brewing_materials %>%
mutate(date=ymd(paste(year,month,1)))
#Question1
head(brewing_materials)
brewing_materials%>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
#Material Used
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(date==max(date)) %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Question1
head(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
# Get the Data
brewing_materials <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewing_materials.csv')
beer_taxed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_taxed.csv')
brewer_size <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/brewer_size.csv')
beer_states <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-31/beer_states.csv')
# Or read in with tidytuesdayR package (https://github.com/thebioengineer/tidytuesdayR)
# PLEASE NOTE TO USE 2020 DATA YOU NEED TO USE tidytuesdayR version ? from GitHub
# Either ISO-8601 date or year/week works!
# Install via devtools::install_github("thebioengineer/tidytuesdayR")
tuesdata <- tidytuesdayR::tt_load('2020-03-31')
tuesdata <- tidytuesdayR::tt_load(2020, week = 14)
brewing_materials <- tuesdata$brewing_materials
brewing_materials <- brewing_materials %>%
mutate(date=ymd(paste(year,month,1))) %>%
brewing_materials <- brewing_materials %>%
mutate(date=ymd(paste(year,month,1))) %>%
filter(year<2016)
#Question1
head(brewing_materials)
brewing_materials%>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current)) %>%
ggplot(aes(type,month_current,fill=material_type))+geom_col()+coord_flip()
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +
labs(x="Time",y="Pounds used in beer production",fill="Material Used")
#Grain or No Grain
brewing_materials %>%
filter(str_detect(material_type,"Total.*products")) %>%
mutate(type=fct_reorder(type,month_current, sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) + theme_bw()
#Material Used
brewing_materials %>%
filter(!str_detect(material_type,"Total")) %>%
mutate(type=fct_reorder(type,month_current,sum)) %>%
ggplot(aes(date,month_current,fill=type))+geom_col()+
scale_y_continuous(labels=scales::comma) +theme_bw()
colnames(brewer_size)
brewer_size %>%
ggplot(aes(year,total_barrels))+geom_col()
brewer_size %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewing_size!="Total") %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewing_size !="Total") %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewer_size !="Total") %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewer_size !="Total") %>%
mutate(brewer_size=fct_reorder(brewer_size,barrel_number)) %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewer_size !="Total") %>%
mutate(brewer_size=fct_reorder(brewer_size,total_barrels)) %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size %>%
filter(brewer_size !="Total",!is.na(total_barrels)) %>%
mutate(brewer_size=fct_reorder(brewer_size,total_barrels)) %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col()
brewer_size <- brewer_size %>%
filter(brewer_size !="Total",!is.na(total_barrels)) %>%
mutate(avg_barrels = total_barrels/n_of_brewers) %>%
mutate(brewer_size = fct_reorder(brewer_size,avg_barrels))
brewer_size %>%
ggplot(aes(x = brewer_size, y = total_barrels)) + geom_jitter() + coord_flip()
brewer_size %>%
ggplot(aes(year,total_barrels,fill=brewer_size))+geom_col() + scale_fill_viridis_d()
brewer_size <- brewer_size %>%
separate(brewer_size, into = c("lower", "upper"), sep = " to", remove = F) %>%
mutate(upper = ifelse(lower == "Under 1 Barrel", 1, upper),
upper = ifelse(lower == "Zero Barrels", 0, upper),
lower = str_remove_all(lower, "[^\\d]"),
upper = str_remove(upper, " Barrels")) %>%
mutate(across(lower:upper, parse_number)) %>%
mutate(upper = ifelse(brewer_size == "6,000,001 Barrels and Over", Inf, upper),
lower = ifelse(brewer_size %in% c("Zero Barrels", "Under 1 Barrel"), 0, lower))
brewer_size %>%
ggplot(aes(year, n_of_brewers, fill = factor(brewer_size))) +
geom_col() +
#scale_fill_continuous(trans = "log10") +
scale_x_continuous(breaks = 2009:2020)
